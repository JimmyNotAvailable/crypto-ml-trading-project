ğŸ“Š KIáº¾N TRÃšC Dá»® LIá»†U CHO Dá»° ÃN CRYPTO BOT
=============================================

PHÃ‚N LOáº I Dá»® LIá»†U:
==================

1. ğŸ“š HISTORICAL DATA (ÄÃ£ cÃ³)
   â€¢ Má»¥c Ä‘Ã­ch: Training + Testing ML models
   â€¢ Vá»‹ trÃ­: /data/cache/ml_datasets_top3.pkl
   â€¢ Äáº·c Ä‘iá»ƒm: ÄÃ£ lÃ m sáº¡ch hoÃ n toÃ n
   â€¢ Sá»­ dá»¥ng: Má»™t láº§n Ä‘á»ƒ train models

2. ğŸ“¡ REALTIME DATA (Cáº§n lÃ m)
   â€¢ Má»¥c Ä‘Ã­ch: Bot responses + Web dashboard
   â€¢ Nguá»“n: API Binance/CoinGecko
   â€¢ Äáº·c Ä‘iá»ƒm: Cáº§n xá»­ lÃ½ realtime
   â€¢ Sá»­ dá»¥ng: LiÃªn tá»¥c cho user queries

3. ğŸ’¾ PROCESSED REALTIME (Cáº§n lÃ m)
   â€¢ Má»¥c Ä‘Ã­ch: ML prediction trÃªn dá»¯ liá»‡u má»›i
   â€¢ Nguá»“n: Realtime data sau khi xá»­ lÃ½
   â€¢ Äáº·c Ä‘iá»ƒm: CÃ¹ng format vá»›i training data
   â€¢ Sá»­ dá»¥ng: Input cho ML models

QUY TRÃŒNH Xá»¬ LÃ:
================

REALTIME DATA PIPELINE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Call      â”‚ -> â”‚  Data Cleaning  â”‚ -> â”‚  Feature Eng.   â”‚
â”‚ (Raw JSON)      â”‚    â”‚ (Validation)    â”‚    â”‚ (MA, Returns)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         v                       v                       v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bot Response  â”‚    â”‚   MongoDB       â”‚    â”‚  ML Prediction  â”‚
â”‚   (!gia BTC)    â”‚    â”‚   Storage       â”‚    â”‚ (Smart Pipeline)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CHI TIáº¾T Xá»¬ LÃ REALTIME:
========================

BÆ¯á»šC 1: RAW DATA COLLECTION
----------------------------
def collect_realtime_price(symbol):
    """Thu tháº­p giÃ¡ realtime tá»« API"""
    response = api.get_price(symbol)
    return {
        'symbol': symbol,
        'price': response['price'],
        'volume': response['volume'],
        'timestamp': datetime.now(),
        'change_24h': response['change_24h']
    }

BÆ¯á»šC 2: DATA VALIDATION
-----------------------
def validate_price_data(data):
    """Kiá»ƒm tra tÃ­nh há»£p lá»‡ cá»§a dá»¯ liá»‡u"""
    if data['price'] <= 0:
        raise ValueError("GiÃ¡ khÃ´ng thá»ƒ Ã¢m")
    if data['price'] > 1000000:  # Bitcoin max price check
        raise ValueError("GiÃ¡ quÃ¡ cao, cÃ³ thá»ƒ lá»—i")
    if pd.isna(data['price']):
        raise ValueError("Missing price data")
    return True

BÆ¯á»šC 3: FEATURE ENGINEERING
---------------------------
def prepare_for_prediction(current_data, historical_window=50):
    """Chuáº©n bá»‹ dá»¯ liá»‡u cho ML prediction"""
    # Láº¥y 50 Ä‘iá»ƒm dá»¯ liá»‡u gáº§n nháº¥t tá»« MongoDB
    recent_data = get_recent_prices(symbol, limit=historical_window)
    
    # TÃ­nh cÃ¡c chá»‰ bÃ¡o ká»¹ thuáº­t
    features = {
        'price': current_data['price'],
        'ma_10': calculate_ma(recent_data, 10),
        'ma_50': calculate_ma(recent_data, 50),
        'volatility': calculate_volatility(recent_data),
        'returns': calculate_returns(recent_data),
        'volume': current_data['volume']
    }
    
    # Chuáº©n hÃ³a vá»›i scaler Ä‘Ã£ train
    scaler = load_scaler_from_training()
    features_scaled = scaler.transform([list(features.values())])
    
    return features_scaled

BÆ¯á»šC 4: ML PREDICTION
---------------------
def predict_price_trend(symbol):
    """Dá»± Ä‘oÃ¡n xu hÆ°á»›ng giÃ¡"""
    # Thu tháº­p dá»¯ liá»‡u má»›i
    current_data = collect_realtime_price(symbol)
    
    # Chuáº©n bá»‹ features
    features = prepare_for_prediction(current_data)
    
    # Load model Ä‘Ã£ train
    model = load_best_model_for(symbol)
    
    # Prediction
    prediction = model.predict(features)
    confidence = model.predict_proba(features) if hasattr(model, 'predict_proba') else 0.5
    
    return {
        'symbol': symbol,
        'current_price': current_data['price'],
        'predicted_trend': prediction[0],
        'confidence': confidence,
        'timestamp': datetime.now()
    }

SO SÃNH Vá»šI TRAINING DATA:
=========================

TRAINING DATA PROCESSING:
â€¢ LÃ m sáº¡ch sÃ¢u: loáº¡i bá» outliers, interpolate missing
â€¢ Feature engineering: táº¡o táº¥t cáº£ features má»™t láº§n
â€¢ Split data: train/val/test theo thá»i gian
â€¢ Normalization: fit scaler trÃªn train set

REALTIME DATA PROCESSING:
â€¢ Validation nháº¹: kiá»ƒm tra format vÃ  giá»›i háº¡n há»£p lÃ½
â€¢ Feature engineering: tÃ­nh toÃ¡n realtime vá»›i window data
â€¢ No splitting: chá»‰ cÃ³ 1 Ä‘iá»ƒm dá»¯ liá»‡u má»›i
â€¢ Normalization: transform vá»›i scaler Ä‘Ã£ fit

Lá»¢I ÃCH:
========

âœ… TÃCH BIá»†T RÃ• RÃ€NG:
- Training data: Tá»‘i Æ°u cho accuracy
- Realtime data: Tá»‘i Æ°u cho speed

âœ… CONSISTENCY:
- CÃ¹ng feature engineering pipeline
- CÃ¹ng scaler vÃ  preprocessing

âœ… SCALABILITY:
- Realtime processing nhanh
- CÃ³ thá»ƒ handle nhiá»u symbols

âœ… RELIABILITY:
- Validation Ä‘áº£m báº£o data quality
- Error handling cho API failures

Káº¾T LUáº¬N:
=========

Dá»® LIá»†U HISTORICAL: 
- ÄÃ£ xong, khÃ´ng cáº§n Ä‘á»™ng vÃ o
- Chá»‰ dÃ¹ng Ä‘á»ƒ train models

Dá»® LIá»†U REALTIME:
- Cáº§n thu tháº­p tá»« API
- Cáº§n xá»­ lÃ½ nháº¹ cho consistency
- DÃ¹ng cho bot responses vÃ  predictions

NEXT STEPS:
- Implement realtime data collector
- Setup MongoDB cho storage
- Táº¡o feature engineering pipeline cho realtime
- Integrate vá»›i existing ML models